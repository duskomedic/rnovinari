---
date: "2016-04-09T16:50:16+02:00"
title: Analiza geo-pozicioniranih podataka
weight: 3
---

R sadrÅ¾i spektar paketa koji vam pruÅ¾aju razne funkcionalnosti kako biste koristili geo-pozicionirane podatke i obavljali kompleksne prostorne analize. Analiza geo-pozicioniranih podataka nije viÅ¡e dostupna samo ekspertima koji rade na skupim kompjuterima i sa skupim softverima. R ima impresivne geografske sposobnosti koje su dostupne svakome ko Å¾eli da ih istraÅ¾uje. 

Pre nego Å¡to se upustimo u geo-prostorno mapiranje u R-u, prvo Ä‡emo da se upoznamo sa osnovnim idejama u vezi sa ovakvim vrstama podataka.

Prostorni podaci sastoje se od:

- Koordinata objekta
- Koordinata  koje su u vezi sa fiziÄkim lokacijama na Zemlji: **koordinatni refentni sistem (coordinate reference system, CRS)**

Postoje dva tipa **CRS-a**:

1) Geografski

  * Posebne lokacije na povrÅ¡ini su definisane uz pomoÄ‡ tridimenzionalnog modela Zemlje. 
  * Geografska duÅ¾ina i Å¡irina

2) Projektovani

  *	Konverzija trodimenzionalne mreÅ¾e na dvodimenzionalnu povrÅ¡inu.

Prema tehnici njihovog Äuvanja, prostorni podaci pripadaju jednoj od dve vrste:

1)	**Rasterski podaci**: sastavljeni od mreÅ¾e Ä‡elija koje su indentifikovane redom i kolonom. Celo geografsko podruÄje je podeljeno na grupe individualnih Ä‡elija, koje predstavljaju sliku (satelitske slike)

2) **Vektorski podaci** sastavljeni su od taÄaka, linija i poligona. Na primer bolnice, kuÄ‡e itd. predstavljene su taÄkama, dok su reke, putevi, itd, predstavljeni linijama. Sela i gradovi su predstavljeni poligonima.

Kada analizirate prostorne podatke takoÄ‘e Ä‡ete raditi i sa kategoriÄkim podacima koji sadrÅ¾e relevantne informacija o prostornim podacima. Analize Ä‡e se zasnivati na kategoriÄkim podacima koji su povezani sa geo-prostornim. Ovakvi podaci mogu biti:

* nominalni
*	redni
*	intervali (interval data)
*	podaci o odnosu  (ratio data),

tj. kategoriÄki ili merljivi tip podataka.

**StatiÄke mape: Shape file** 

R poseduje impresivne geografske kapacitete i moÅ¾e da obraÄ‘uje fajlove razliÄitih vrsta prostornih podataka ukljuÄujuÄ‡i geojson i KML. IlustrovaÄ‡emo upotrebu ESRI (shapefile) fajlova formata, koji Äuvaju netopoloÅ¡ku geometiju i kategoriÄke informacije za prostorne odlike u setu podataka. Ovi podaci sastavljeni su od glavnog fajla, index fajla i dBASE tabele.

-	.shp â€“ lista oblika i verteksa
-	.shx â€“ sadrÅ¾i indeks sa ofsetima
-	.dbf â€“ fajl odnosa izmeÄ‘u geometrije i kategoriÄkih podataka

Da biste pravilno uvezli datoteku ESRI oblika u R, sve tri datoteke moraju biti prisutne u direktorijumu i moraju imatu isto ime (osim ekstenzije koja se odnosi na tip fajla).

PoÄeÄ‡emo sa uÄitavanjem shape file-a regiona Srbije koja je dostupna na [GADM maps and data](https://gadm.org/download_country_v3.html).

Prvo, preuzmite fajlove koji su nam portrebni sa sledeÄ‡eg GitHub repozitorija: <https://github.com/TanjaKec/gadm36_SRB_shp>. Obavezno saÄuvajte fajl u radni direktorijum svoga R-projekta pre nego Å¡to zatraÅ¾ite od R da izvrÅ¡i sledeÄ‡i kod

```
## If you don't have sf installed yet, uncomment and run the line below
#install.packeges("sf")

library(ggplot2)
library(sf)

#pointed to the shape file
serbia_location <- "gadm36_SRB_1.shp"

#used the st_read() function to import it
serbia_districts <- st_read(serbia_location)

# take a look at the file
View(serbia_districts)

# plot the disstricts 
ggplot(serbia_districts) + 
  geom_sf()
```

![](/day2/SpatialDA/images/serbia.png?width=40pc)

Ovo dobro izgleda ğŸ˜ƒ SledeÄ‡e, Å¡to Å¾elimo da dodamo su podaci i da ih potom â€obojimoâ€œ. DodaÄ‡emo podatke o broju stanovnika u Srbiji u 2017. godini koji su nam dostupni preko fajla â€œSerbian_Pop.csvâ€ file.  

```
population <- read.csv("Serbian_Pop.csv")
View(population)

library(dplyr)

serbia_pop <- left_join(serbia_districts, population,
                          by=c("NAME_1" = "District"))

View(serbia_pop)


ncol(serbia_districts)

ncol(population)

ncol(serbia_pop)

names(serbia_pop)


ggplot(serbia_pop) +
  geom_sf(aes(fill=total_pop)) +
  scale_fill_distiller(direction = 1, name = "Population") +
  labs(title="Population of Serbia for 2017", caption="Source: Statisticki Zavod SR")
```

![](/day2/SpatialDA/images/SR_pop_2017.png?width=40pc)

Ponekad biste moÅ¾da Å¾eleli da predstavite regione kao zasebne delove jedan pored drugog. Zapamtite, ovo moÅ¾ete uraditi i upotrebom `facet` funkcije iz `ggplot` biblioteke.

```
ggplot(serbia_pop) +
  geom_sf(aes(fill = total_pop)) +
  scale_fill_distiller(direction = 1, name = "Population") +
  labs(title="Population of Serbia for 2017", caption="Source: Statisticki Zavod SR") +
  facet_wrap(~NAME_1)
```

![](/day2/SpatialDA/images/facet_sr.png?width=40pc)

**Interaktivne mape: leaflet**

`Leaflet` je jedan od najpopularnijih JavaScript biblioteka otvorenog koda za interktivne mape koja je integrisana u R, zahvaljuÄ‡i grupi ljudi iz Rstudija. PokazaÄ‡emo kako je jednostavno da se napravi mapa lokacija uz pomoÄ‡ leaflet paketa, a moÅ¾ete da nauÄite viÅ¡e o ovom paketu sa stranice [Leaflet for R](https://rstudio.github.io/leaflet/) website.

```{r}
## If you don't have leaflet installed yet, uncomment and run the line below
#install.packeges("leaflet")
library(leaflet)
# Initialize and assign us as the leaflet object
us <- leaflet() %>%
  # add tiles to the leaflet object
  addTiles() %>%  
  # setting the centre of the map and the zoom level
  setView(lng = 21.43667, lat = 41.99578, zoom = 15) %>% 
  # add a popup marker 
  addMarkers(lng = 21.43551, lat = 41.99405, popup = "<b>Ciao!</b><br><a href='http://balkansmedia.org/innovation-lab/2nd-media-innovation-lab-master-classes-and-presentations'>2nd Media Innovation Lab! ğŸ˜€</a>")

us
```

Pogledajte zanimljivu veb stranicu koja vam pokazuje razne moguÄ‡nosti da kreirate mapa sa ['leaflet'](https://maptimeboston.github.io/leaflet-intro/). Dobro pogledajte i nastavite da istraÅ¾ujete sami.

{{% notice note %}}
Od svoje orginalne primene kao statistiÄkog programskog jezika, R je preÅ¡ao dug put i postao vrlo moÄ‡an kao podrÅ¡ka za prostorne analize. Svi R paketi ukljuÄuju vinjete sa objaÅ¡njenjima sintakse funkcija i Äesto sa veoma korisnim mini-tutorijalima koji ilustruju praktiÄnu upotrebu funkcija na neki zadat problem. [CRAN Task View for Analysis of Spatial Data ](https://cran.r-project.org/web/views/Spatial.html) vam pruÅ¾a listu dostupnih biblioteka R-u za geografsko mapiranje koje se Äesto koriste u prostornim analizama i projektima mapiranja u R-u. 
{{% /notice %}}


**ZADACI ğŸ‘‡**

VeÅ¾bajte na sledeÄ‡em setu zadataka:

1)	UÄitajte shape file regiona u Srbiji na osnovu [GADM maps and data](https://gadm.org/download_country_v3.html) i ucrtajte broj stanovnika po kvadratnom kilometru, uz pomoÄ‡ podataka koji su dostupni u â€˜Serbian_Pop.csvâ€™ koje smo veÄ‡ koristili.

2)	Napravite mapu koja Ä‡e obeleÅ¾iti vaÅ¡e omiljeno mesto za druÅ¾enje tako Å¡to Ä‡ete koristiti paket leaflet.



**Korisni linkovi:** 

[R for the analysis of spatial or spatio-temporal data (blog)](https://www.r-spatial.org/)

[Geocomputation with R](https://geocompr.robinlovelace.net/): knjiga o analizi geografskih podataka, vizuelizaciji i modelovanju.

[GADM maps and data](https://gadm.org/download_country_v3.html)

[Creating Interactive Spatial Maps in R Using Leaflet](https://www.earthdatascience.org/courses/earth-analytics/get-data-using-apis/leaflet-r/)

[Thematic Mapping with tmap](https://map-rfun.library.duke.edu/031_thematic_mapping.html)

-----------------------------
Â© 2019 [Sister Analyst](https://sisteranalyst.org)
